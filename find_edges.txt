IFS=$'\n' # make new lines the only separator

echo -e "Find lines containing edges in input file (first argument) and save results into new file (second argument)\n"

# Create the file that will contain edges
echo -n "" > "$2"

# declare variable as integers
declare -i start_overlap_first=0
declare -i end_overlap_first=0
declare -i length_first=0
declare -i start_overlap_second=0
declare -i end_overlap_second=0
declare -i length_second=0

# Loop through lines and check for edges for the file given as argument
for line in $(cat "$1")
	do
		# get values per line
		start_overlap_first=$(echo "$line" | awk '{ print $3 }')
		end_overlap_first=$(echo "$line" | awk '{ print $4 }')
		length_first=$(echo "$line" | awk '{ print $5 }')
		start_overlap_second=$(echo "$line" | awk '{ print $6 }')
		end_overlap_second=$(echo "$line" | awk '{ print $7 }')
		length_second=$(echo "$line" | awk '{ print $8 }')
		
		# cacluate lengths of overlaps
		length_overlap_first=$((end_overlap_first - start_overlap_first ))
		length_overlap_second=$((end_overlap_second - start_overlap_second ))
		
		# check if overlap is at end of first contig and is at least of length 1000
		if [[ ( $end_overlap_first == $length_first ) && ( $length_overlap_first -gt 999 ) ]]
		then
			overlap_end_long_first=true
		else
			overlap_end_long_first=false
		fi
		
		# check if overlap is at start of second contig and is at least of length 1000
		if [[ ( $start_overlap_second == 0 ) && ( $length_overlap_second -gt 999 ) ]]
		then
			overlap_start_long_second=true
		else
			overlap_start_long_second=false
		fi
		
		# check if edge and save in file with edges if true
		if [[ ( $overlap_end_long_first = true ) &&  ( $overlap_start_long_second = true ) ]]
		then
			edge=true
			echo $line >> "$2"
		else
			edge=false
		fi
done